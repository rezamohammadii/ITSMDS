@page "/role/create"
@using ITSMDS.Core.Application.DTOs
@using ITSMDS.Web.ApiClient
@inject RoleApiClient roleApi
<PageTitle>اضافه کردن نقش </PageTitle>


<div class="d-flex align-items-center justify-content-between gap-4 flex-wrap mb-5">
    
    <div class="d-flex flex-column">
        <h3 class="mb-1">افزودن نقش جدید</h3>
        <h6 class="mb-0 text-muted">افزودن نقش ها و مجوز های سیستم</h6>
    </div>

    <Button Color="ButtonColor.Warning" Class="ms-auto">
        <Icon Name="IconName.ArrowRight" /> بازگشت
    </Button>
</div>



<Card Class="mb-5 shadow-lg mx-auto" Style="width: 70%;">
    <CardBody class="text-end">
        <CardTitle class="mb-4 fw-bold">اطلاعات نقش</CardTitle>
        <EditForm Model="roleDtoIn" OnValidSubmit="HandleValidSubmit" class="row g-3" FormName="AddRole">
            <DataAnnotationsValidator />
            <ValidationSummary />
            <div class="mb-3 text-muted">نام نقش </div>

            <div class="mb-3">
                <TextInput @bind-Value="@roleDtoIn.RoleName" TextAlignment="Alignment.End" Class="form-control" />
            </div>

            <div class="mb-3 text-muted">توضیحات </div>

            <div class="mb-3">
                <TextAreaInput @bind-Value="@roleDtoIn.Description" Rows="5" TextAlignment="Alignment.End" Class="form-control" />
            </div>
            <div class="mb-3 d-flex justify-content-start align-items-center gap-2">
                <CheckboxInput Label="نقش فعال" @bind-Value="roleDtoIn.IsActive" />
            </div>



            <Button Color="ButtonColor.Success" Type="ButtonType.Submit" Class="mt-3 w-100">
                اضافه کردن نقش
            </Button>
            @if (isShowAlert is not null)
            {
                if (isShowAlert.Value)
                {
                    <Alert Color="AlertColor.Success" @ref="alert"> <Icon Name="IconName.CheckCircleFill" class="me-2"></Icon>نقش با موفقیت اضافه شد  </Alert>
                }
                else
                {
                    <Alert Color="AlertColor.Danger" @ref="alert"> <Icon Name="IconName.CheckCircleFill" class="me-2"></Icon>مشکلی در اضافه کردن نقش وجود دارد </Alert>
                }
            }
           
        </EditForm>
    </CardBody>
</Card>





@code {
    private RoleDtoIn? roleDtoIn = new RoleDtoIn();
    private string? enteredText = "sample text";
    private bool? isShowAlert = null;
    Alert alert;
    private async Task HandleValidSubmit()
    {
        var result = await roleApi.CreateRoleAsync(roleDtoIn);
        if (result)
        {
            isShowAlert = true;

        }else{
            isShowAlert = false;
        }
    }
}
