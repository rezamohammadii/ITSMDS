@page "/user/create"
@using ITSMDS.Web.ViewModel
@inject IConfiguration Configuration
@inject IJSRuntime JS
@inject NavigationManager NavigationManager

<EditForm Model="@user" OnValidSubmit="HandleValidSubmit" class="space-y-6" @ref="myform">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="d-flex align-items-center gap-4">
        <button type="button" class="btn btn-outline-secondary" @onclick="NavigateToUsers">
            🡐 بازگشت
        </button>
        <div>
            <h1 class="h4 fw-bold text-dark">افزودن کاربر جدید</h1>
            <p class="text-muted mt-1">ایجاد حساب کاربری جدید در سیستم</p>
        </div>
    </div>

    <div class="row g-4">
        <div class="col-md-6">
            <label class="form-label">نام *</label>
            <InputText class="form-control" @bind-Value="user.FirstName" placeholder="نام را وارد کنید" />
            <ValidationMessage For="@(() => user.FirstName)" />
        </div>

        <div class="col-md-6">
            <label class="form-label">نام خانوادگی *</label>
            <InputText class="form-control" @bind-Value="user.LastName" placeholder="نام خانوادگی را وارد کنید" />
            <ValidationMessage For="@(() => user.LastName)" />
        </div>
    </div>

    <div class="row g-4">
        <div class="col-md-6">
            <label class="form-label">کد پرسنلی *</label>
            <InputText class="form-control" @bind-Value="user.PersonalCodeString" placeholder="EMP001" />
            <ValidationMessage For="@(() => user.PersonalCodeString)" />
        </div>

        <div class="col-md-6">
            <label class="form-label">نام کاربری *</label>
            <InputText class="form-control" @bind-Value="user.UserName" placeholder="user.name" />
            <ValidationMessage For="@(() => user.UserName)" />
        </div>
    </div>

    <div class="row g-4">
        <div class="col-md-6">
            <label class="form-label">ایمیل سازمانی *</label>
            <InputText class="form-control text-start" @bind-Value="user.Email" placeholder="user@company.com" />
            <ValidationMessage For="@(() => user.Email)" />
        </div>

        <div class="col-md-6">
            <label class="form-label">تلفن دفتر *</label>
            <InputText class="form-control text-start" @bind-Value="user.PhoneNumber" placeholder="+9821-12345678" />
            <ValidationMessage For="@(() => user.PhoneNumber)" />
        </div>
    </div>

    <!-- اطلاعات سیستم -->
    <div class="row g-4">
        <div class="col-md-6">
            <label class="form-label">آی‌پی سیستم *</label>
            <InputText class="form-control text-start" @bind-Value="user.IpAddress" placeholder="192.168.1.100" />
            <ValidationMessage For="@(() => user.IpAddress)" />
        </div>
    </div>

    <!-- دکمه‌های فرم -->
    <div class="d-flex gap-3 pt-4 border-top">
        <button type="submit" class="btn btn-success" disabled="@isSubmitting">
            💾 @(isSubmitting ? "در حال ذخیره..." : "ذخیره کاربر")
        </button>

        <button type="button" class="btn btn-outline-secondary" @onclick="HandleReset" disabled="@isSubmitting">
            🔄 بازنشانی
        </button>

        <button type="button" class="btn btn-light" @onclick="HandleCancel" disabled="@isSubmitting">
            ❌ انصراف
        </button>
    </div>
</EditForm>



@code {
    EditForm myform;
    EditForm myform2;

    Alert aaa;



    private UserModel user = new();
    private bool isSubmitting = false;

    private void HandleValidSubmit()
    {

        var fff = myform.Model as UserModel;
        isSubmitting = true;
        // ذخیره‌سازی اطلاعات کاربر
        // ...
        isSubmitting = false;
    }

    private void HandleReset()
    {
        user = new();
    }

    private void HandleCancel()
    {
        // بازگشت یا بستن فرم
    }

    private void NavigateToUsers()
    {
        NavigationManager.NavigateTo("/users");
    }


}