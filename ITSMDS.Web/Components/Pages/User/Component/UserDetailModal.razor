
<div class="d-flex align-items-center">
    <Icon Name="IconName.PersonCircle" Class="text-primary me-3" Size="IconSize.x4"></Icon>
    <div>
        <h5 class="mb-0">اطلاعات کاربر</h5>
        <small class="text-muted">جزئیات کامل پروفایل کاربر</small>
    </div>
</div>


@if (User != null)
{
    <div class="user-details">
        <!-- اطلاعات اصلی کاربر -->
        <div class="row mb-4">
            <div class="col-md-6 mb-3">
                <div class="detail-item">
                    <div class="detail-icon bg-primary-subtle">
                        <Icon Name="IconName.Person" Class="text-primary"></Icon>
                    </div>
                    <div class="detail-content">
                        <div class="detail-label">نام کامل</div>
                        <div class="detail-value">@($"{User.FirstName} {User.LastName}")</div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="detail-item">
                    <div class="detail-icon bg-success-subtle">
                        <Icon Name="IconName.PersonBadge" Class="text-success"></Icon>
                    </div>
                    <div class="detail-content">
                        <div class="detail-label">نام کاربری</div>
                        <div class="detail-value">@User.UserName</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- اطلاعات تماس -->
        <div class="row mb-4">
            <div class="col-md-6 mb-3">
                <div class="detail-item">
                    <div class="detail-icon bg-info-subtle">
                        <Icon Name="IconName.Envelope" Class="text-info"></Icon>
                    </div>
                    <div class="detail-content">
                        <div class="detail-label">ایمیل</div>
                        <div class="detail-value">@User.Email</div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="detail-item">
                    <div class="detail-icon bg-warning-subtle">
                        <Icon Name="IconName.Telephone" Class="text-warning"></Icon>
                    </div>
                    <div class="detail-content">
                        <div class="detail-label">تلفن</div>
                        <div class="detail-value">@(string.IsNullOrEmpty(User.PhoneNumber) ? "ثبت نشده" : User.PhoneNumber)</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- اطلاعات سیستمی -->
        <div class="row mb-4">
            <div class="col-md-6 mb-3">
                <div class="detail-item">
                    <div class="detail-icon bg-secondary-subtle">
                        <Icon Name="IconName.Globe" Class="text-secondary"></Icon>
                    </div>
                    <div class="detail-content">
                        <div class="detail-label">آی‌پی آدرس</div>
                        <div class="detail-value">@User.IpAddress</div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="detail-item">
                    <div class="detail-icon bg-dark-subtle">
                        <Icon Name="IconName.Calendar" Class="text-dark"></Icon>
                    </div>
                    <div class="detail-content">
                        <div class="detail-label">تاریخ ایجاد</div>
                        <div class="detail-value">@((User.CreateDate == null) ? "" : User.CreateDate.ToString())</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- تیم و نقش‌ها -->
        <div class="row mb-4">
            <div class="col-md-6 mb-3">
                <div class="detail-item">
                    <div class="detail-icon bg-primary-subtle">
                        <Icon Name="IconName.People" Class="text-primary"></Icon>
                    </div>
                    <div class="detail-content">
                        <div class="detail-label">تیم</div>
                        <div class="detail-value">@(string.IsNullOrEmpty(User.TeamName) ? "ثبت نشده" : User.TeamName)</div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="detail-item">
                    <div class="detail-icon bg-success-subtle">
                        <Icon Name="IconName.Shield" Class="text-success"></Icon>
                    </div>
                    <div class="detail-content">
                        <div class="detail-label">نقش‌ها</div>
                        <div class="detail-value">
                            @if (User.RoleName is IEnumerable<string> roles && roles.Any())
                            {
                                @foreach (var role in roles)
                                {
                                    <span class="badge bg-primary me-1">@role</span>
                                }
                            }
                            else
                            {
                                <span class="text-muted">هیچ نقشی تعریف نشده</span>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- وضعیت کاربر -->
        <div class="row">
            <div class="col-12">
                <div class="detail-item">
                    <div class="detail-icon @(User.IsActive ? "bg-success-subtle" : "bg-danger-subtle")">
                        <Icon Name="@(User.IsActive? IconName.CheckCircle: IconName.XCircle)" Class="@(User.IsActive ? "text-success" : "text-danger")"></Icon>
                    </div>
                    <div class="detail-content">
                        <div class="detail-label">وضعیت حساب</div>
                        <div class="detail-value">
                            @if (User.IsActive)
                            {
                                <span class="badge bg-success">فعال</span>
                            }
                            else
                            {
                                <span class="badge bg-danger">غیرفعال</span>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}
else
{
    <div class="text-center py-4">
        <Icon Name="IconName.ExclamationTriangle" Size="IconSize.x4" Class="text-warning mb-3"></Icon>
        <p class="text-muted">هیچ اطلاعاتی برای نمایش وجود ندارد.</p>
        <!-- debugging aid -->
        <pre class="small text-muted">Debug: User == null</pre>
    </div>
}



@code {
    private Modal userModal;

    [Parameter] public UserViewModel User { get; set; }

    protected override Task OnInitializedAsync()
    {
        return base.OnInitializedAsync();
    }
}
